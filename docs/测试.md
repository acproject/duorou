DUOROU_GGUF_FILE=/absolute/path/to/model.gguf DUOROU_TOKENIZER_TYPE=bpe DUOROU_ADD_SPECIAL=0 ./src/model/tokenizer_golden_test
通过上面的测试可以查看guff文件词表映射与中文解码的兼容性

建立 ggml 后端骨架：在 /src/ml/backend 下新增 ggml_backend.{h,cpp}，封装 ggml_context/graph 的创建、权重张量注册、临时张量/工作区管理

扩展 GGUF 读取：在 GGUFParser 暴露按张量名读取到缓冲区/指针的 API（支持 mmap 零拷贝），用于直接喂给 ggml 张量

权重索引与映射：实现 Qwen2.5VL 张量命名->结构映射（embedding、每层 attn/qkv/o、ffn/gate/up/down、norms、lm_head、vision_*、projector_* 等），校验维度一致性

RoPE 与位置编码：在 ggml_backend 中提供 rope 频率预计算与按步增量应用（含 rope_scale/base/shortening 等从 GGUF 读取）

KV Cache 对接：把 /src/kvcache 的抽象与 ggml 张量对齐，支持按层的 K/V 追加与检索，并暴露 step-by-step decode 接口

自注意力图块：用 ggml op 组装 Qwen 样式的注意力（含 qk^T / softmax / 采样掩码 / kvheads），与 KV Cache 集成

Transformer Block 组装：按层次结构串联 LN -> Attn -> 残差 -> LN -> FFN -> 残差；支持逐 token 解码图重用

文本路径最小可用：不带视觉的 text-only infer（encode->step decode->sample），跑通小 max_tokens 的生成

视觉编码器：基于 GGUF 的 vision.* 权重搭建 ViT/Conv-Patch 图，完成图像到视觉 token 的特征

投影/对齐模块：实现 vision->LLM 的 projector（线性/MLP/适配器），并与多模态特殊 token 流程对齐

内部 Forward 接口：在 InferenceEngine::generateWithInternalForward 调用 ggml_backend 的 step-decode，实现统一采样/停止条件

集成测试：最小文本生成（text-only），最小多模态生成（含一张图），与现有 InferenceEngine/Model 管线打通

前馈网络图块：实现 SwiGLU/GEGLU/SiLU 等可配置激活路径，支持从元数据读取激活类型

多模态拼接：在 qwen_multimodal_model 中把视觉 token 序列插入文本序列（含 <|vision_start|> 等特殊 token）

采样与logits后处理：温度、top-p、top-k、重复惩罚、bad words/stop tokens，统一到 utils

内存与性能：激活缓存复用、分层常驻图/一次性图、张量别名和 quant 权重直接计算，避免拷贝

单元测试：GGUF 张量读取、维度校验、rope、attention/ffn 数学正确性（小张量伪数据）

工程化：CMake 集成（可选 Metal/OpenCL 开关）、日志/错误边界、参数化配置（threads、batch、rope 等）

回归现有待办：运行最小推理用例，设置 DUOROU_FORCE_LLAMA=1 验证日志路径（或明确错误提示），以及 Qwen 架构下强制 llama 的行为说明

文档与示例：README_QWEN.md 增补使用说明（模型要求、示例命令、性能建议）